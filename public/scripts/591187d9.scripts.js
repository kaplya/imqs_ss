"use strict";var imqsCsApp=angular.module("imqsCsApp",["ngResource","ico"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/journals",{templateUrl:"views/main.html",controller:"JournalsPageCtrl"}).otherwise({redirectTo:"/"})}]),imqsCsAppDev=angular.module("imqsCsAppDev",["imqsCsApp","ngMockE2E"]);imqsCsAppDev.run(["$httpBackend",function(a){var b=[{id:1,number:"0001",description:"Cool journal",journal_type:1,location_id:1,to_location_id:2}];a.whenGET("/invent_journals").respond(b),a.whenPOST("/invent_journals").respond(function(a,c,d){var e=angular.fromJson(d),f={};if(e.number==null||e.number=="")f.number=["can't be null","the second error","the third error"];if(e.description==null||e.description=="")f.description=["can't be null"];return e.description!=e.number&&(f.main=["description should be equal number"]),$.isEmptyObject(f)?(e.mode="",e.class="",e.id=2,b.push(angular.fromJson(e)),[200]):[400,f]}),a.whenDELETE(/\/invent_journals\/[1-9]/).respond(function(a,b,c,d){var e=/([^\/]+)$/mg;return[200]}),a.whenPUT(/\/invent_journals\/[1-9]/).respond(function(a,b,c,d){return[200]});var c={1:[{id:1,journal_id:1,item_id:1,dimension_id:1,to_dimension_id:2,qty:15}]};a.whenGET(/^\/invent_journal_lines/).respond(function(a,b,d,e){var f=/[\\?&]journal_id=([^&#]*)/.exec(b)[1];return[200,c[f]]}),a.whenPOST(/\/invent_journal_lines/).respond(function(a,b,d,e){var f=angular.fromJson(d);f.id=2,f.type="test type",f.mode=null,console.log(f.journal_id);var g={};f.dimension_id==f.to_dimension_id&&(g.main=["dimensions should be different"]);if(f.item_id==null||f.item_id=="")g.item_id=["shouldn't be blank"];return $.isEmptyObject(g)?(c[f.journal_id]||(c[f.journal_id]=[]),c[f.journal_id].push(f),[200,angular.toJson(f)]):[400,g]}),a.whenPUT(/\/invent_journal_lines\/[1-9]/).respond(function(a,b,c,d){return[200]}),a.whenDELETE(/\/invent_journal_lines\/[1-9]/).respond(function(a,b,c,d){return[200]}),a.whenGET(/^views\//).passThrough()}]),jQuery(function(){}),"use strict",imqsCsApp.controller("MainCtrl",["$scope",function(a){a.header="Greeting",a.dataUrl="views/welcome.html"}]),"use strict",imqsCsApp.factory("Journal",["$resource",function(a){return a("/invent_journals/:id/:action")}]).controller("JournalsPageCtrl",["$scope",function(a){a.header="Journals",a.dataUrl="views/journals.html"}]).controller("JournalsContentCtrl",["$scope","Journal",function(a,b){a.loading="true",a.journals=b.query(function(){a.loading="false"}),a.new=function(){var b=[{"class":"new-form",mode:"edit",show_lines:!1}];a.journals=b.concat(a.journals)}}]).controller("JournalCtrl",["$scope","Journal","JournalLine",function(a,b,c){a.$watch("j.show_lines",function(b){b?(a.loading="true",console.log(a.$id),a.j.lines=c.query({journal_id:a.j.id},function(){a.loading="false"})):(a.j.lines=[],a.loading="false")}),a.createOrUpdate=function(){var c=a;c.j.mode="loading",c.j.errors=null,c.j.id==undefined?b.create(null,c.j,function(a){$.extend(c.j,a),c.j.class=null,c.j.mode="show",c.j.lines=[{journal_id:c.j.id,mode:"edit"}],c.j.show_lines=!0},function(a){c.j.mode="edit",c.j.errors=a.data}):b.update({id:c.j.id},c.j,function(a){c.j.mode="show"},function(){c.j.errors=r.data,c.j.mode="edit"})},a.cancel=function(){var b=a.j;if(b.id==undefined){var c=$.grep(a.journals,function(a){return a!=b});a.journals.splice(0,a.journals.length),$.merge(a.journals,c)}else b.mode="show"},a.destroy=function(){var c=this.j;c.mode="loading",b.destroy({id:c.id},null,function(){var b=$.grep(a.journals,function(a){return a!=c});a.journals.splice(0,a.journals.length),$.merge(a.journals,b)},function(){alert("error")})}}]),"use strict",imqsCsApp.factory("JournalLine",["$resource",function(a){return a("/invent_journal_lines/:id/:action")}]).controller("JournalLinesCtrl",["$scope","JournalLine",function(a,b){a.j.lines=[],a.new=function(){a.j.lines=[{journal_id:a.j.id,mode:"edit"}].concat(a.j.lines)}}]).controller("JournalLineFormCtrl",["$scope","JournalLine",function(a,b){a.createOrUpdate=function(){var c=a;c.l.mode="loading",c.l.errors=null,c.l.id==undefined?b.create(null,c.l,function(a){$.extend(c.l,a),c.l.mode="show"},function(a){c.l.mode="edit",c.l.errors=a.data}):b.update({id:c.l.id},c.l,function(a){c.l.mode="show"},function(a){c.l.mode="edit",c.l.errors=a.data})},a.cancel=function(){var b=a.l;if(b.id==undefined){var c=$.grep(a.j.lines,function(a){return a!=b});a.j.lines.splice(0,a.j.lines.length),$.merge(a.j.lines,c)}else b.mode="show"},a.destroy=function(){var c=a.l;c.mode="loading",b.destroy({id:c.id},null,function(){a.j.lines=$.grep(a.j.lines,function(a){return a!=c})})}}]);